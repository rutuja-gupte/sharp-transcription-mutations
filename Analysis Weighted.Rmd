---
title: "Analysis Weighted"
author: "Rutuja"
date: "2024-04-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Import statements

```{r}
library(tidyverse)
```

Required keys

```{r}
chr_names<-c("chrI","chrII","chrIII","chrIV","chrV","chrVI","chrVII","chrVIII", "chrIX","chrX","chrXI","chrXII","chrXIII","chrXIV","chrXV","chrXVI")

chr_names2<-c("chr01","chr02","chr03","chr04","chr05","chr06","chr07","chr08","chr09","chr10","chr11","chr12","chr13","chr14","chr15","chr16")
```

# Reading in files

```{r}
# power to detect mutations
power<-read.delim("power_by_site_with_bases.txt",h=F)
names(power)<-c("chr","pos","hap.wt","hap.del","dip.wt","dip.del","ref")
power$chr_num<-sapply(power$chr,function(i){which(chr_names2==i)})
d <- power %>% select(chr_num, pos, ref, hap.wt, hap.del, dip.wt, dip.del)
d$pwr.tot<-rowSums(d[,c(4:7)])
```

```{r}
net <- read.csv("net_mapped/weighted_net.csv")
```

```{r}
df.plus <- net[net$strand == "+",]
df.minus <- net[net$strand == "-",]

d <- d %>% left_join(df.minus[,c("pos", "chr_num", "total", "feature")], by=c('pos', 'chr_num'), suffix = c("", ".minus"))
d <- d %>% rename("net_tot.minus" = "total",
                            "class.minus" = "feature")
d <- d %>% left_join(df.plus[,c("pos", "chr_num", "total", "feature")], by=c('pos', 'chr_num'), suffix = c("", ".plus"))
d <- d %>% rename("net_tot.plus" = "total",
                            "class.plus" = "feature")

d$pos500 <- ((d$pos-1) %/% 1000) * 1000 + 501
```


Starting with the replication dynamics data first

```{r}
rep.dynamics <- read.csv("replication_data/clean_rep.csv")
```

```{r}
d <- d %>% left_join(rep.dynamics[,c("pos","chr_num", "ratio", "rep.slope", "rep.sign")], by=c("chr_num", "pos500"="pos"))
```

# Now combining mutation data

Reading in the mutation data

```{r}
mut <- load("mutation_data/Sharp_etal_variants")
```

Filter to keep specific columns

```{r}
test.rv <- rv %>% select(CHROM, POS, REF, ALT, TYPE, RDH, MAT, ploidy, allele.freq, chr_copy_num, aneu11, indel.type, genic, mut.type, NCALLED)

test.rv$chr_num <- sapply(test.rv$CHROM,function(i){which(chr_names2==i)})
test.rv <- test.rv %>% rename("pos" = "POS")
```

Final join

```{r}
d <- d %>% left_join(test.rv, by = c("chr_num", "pos"))
```

# Generating more useful calculated columns

```{r}
d$net_tot.minus <- d$net_tot.minus %>% replace_na(0)
d$net_tot.plus <- d$net_tot.plus %>% replace_na(0)
d$net_tot <- d$net_tot.minus + d$net_tot.plus
d <- d %>% mutate(tr.or.not = case_when(
  !is.na(class.minus) | !is.na(class.plus) ~ TRUE,
  TRUE ~ FALSE
))

d <- d %>% mutate(class = case_when(
  !is.na(class.minus) & is.na(class.plus) ~ class.minus,
  is.na(class.minus) & !is.na(class.plus) ~ class.plus,
  !is.na(class.minus) & !is.na(class.plus) ~ "both",
  TRUE ~ "none"
))

d <- d %>% mutate(transcribed = ifelse(d$net_tot > 0, TRUE, FALSE))

df <- d
rm(d)

df <- df %>% select(-CHROM)
df$net_tot.minus <- replace_na(df$net_tot.minus, 0)
df$net_tot.plus <- replace_na(df$net_tot.plus, 0)
df$class.minus <- replace_na(df$class.minus, "none")
df$class.plus <- replace_na(df$class.plus, "none")
df$net_tot.minus <- replace_na(df$net_tot.minus, 0)
df$net_tot.plus <- replace_na(df$net_tot.plus, 0)
df$allele.freq <- replace_na(df$allele.freq, 0)
df$genic <- replace_na(df$genic, FALSE)
df$NCALLED <- replace_na(df$NCALLED, 0)
df <- df %>% mutate(mutated = ifelse(df$NCALLED > 0, 1, 0))
df$rep.strand <- df$rep.sign

ready.cols <- sapply(df, function(x)all(!is.na(x)))
ready.cols[ready.cols]
```

Adding some collision info here

```{r}
collisions <- df %>% select(chr_num, pos, rep.strand, net_tot.minus, net_tot.plus, mutated)
```

So for the transcription direction, I am using the direction of whatever is greater between net_tot.plus and net_tot.minus. Finding all the collisions spots.

```{r}
collisions <- collisions %>% mutate(tr.strand = case_when(
  net_tot.minus > net_tot.plus ~ -1,
  net_tot.plus > net_tot.minus ~ 1,
  TRUE ~ 0
))

collisions <- collisions %>% mutate(collision = case_when(
  rep.strand * tr.strand == 1 ~ 1,
  TRUE ~ 0
))

collisions <- collisions %>% mutate(net_tot = net_tot.minus + net_tot.minus)

collisions$class <- df$class
collisions <- collisions %>% mutate(ORF = ifelse(class == "ORF" | class == "ORFs", 1, 0))
collisions <- collisions %>% mutate(CDS = ifelse(class == "CDS", 1, 0))

# collisions$ORF.scaled = scale(collisions$ORF)
# collisions$CDS.scaled = scale(collisions$CDS)

collisions$type <- df$TYPE

collisions <- collisions %>% mutate(SNM = ifelse(type == "SNP", 1, 0))
collisions$SNM <- replace_na(collisions$SNM,0)
collisions <- collisions %>% mutate(INDEL = ifelse(type == "INDEL", 1, 0))
collisions$INDEL <- replace_na(collisions$INDEL, 0)

collisions$ref <- df$ref
collisions$rep.ratio <- df$ratio

collisions$rep.ratio <- replace_na(collisions$rep.ratio, 1)
collisions$rep.ratio.scaled <- scale(collisions$rep.ratio)
collisions <- collisions %>% mutate(ref.type = case_when(
  ref == "A" | ref == "T" ~ "A/T",
  ref == "G" | ref == "C" ~ "G/C",
  TRUE ~ NA
))
```

Trying to make a large model and working my way backwards. Making another testing dataframe

```{r}
test.df <- collisions[,c("chr_num", "pos", "rep.strand", "mutated", "collision", "net_tot", "rep.ratio", "CDS", "SNM", "INDEL", "ref.type", "tr.strand")]
test.df$pwr.tot <- df$pwr.tot
test.df$rep.slope <- df$rep.slope
```

Making a scaled dataset

```{r}
df.scaled <- test.df[, c("chr_num", "pos", "mutated", "SNM", "INDEL", "ref.type", "CDS", "rep.strand", "collision", "tr.strand")]
# df.scaled$rep.strand <- scale(test.df$rep.strand)
# df.scaled$collision <- scale(test.df$collision)
df.scaled$net_tot <- test.df$net_tot
# df.scaled$net_tot <- scale(test.df$net_tot)
df.scaled$rep.ratio <- scale(test.df$rep.ratio)
df.scaled$rep.slope <- scale(test.df$rep.slope)
df.scaled$pwr.tot <- scale(test.df$pwr.tot)
# df.scaled$CDS <- scale(test.df$CDS)
```


For a change: some graphs

```{r}
bind_rows(df.scaled[(df.scaled$SNM==1),][1:500,], df.scaled[sample(nrow(df.scaled), 500),]) %>%
  # df.scaled[sample(nrow(df.scaled), 10000),] %>%
  ggplot() +
  geom_point(aes(y=rep.ratio, x=net_tot, color=as.character(SNM))) +
  scale_x_log10() 

bind_rows(df.scaled[(df.scaled$SNM==1),][1:500,], df.scaled[sample(nrow(df.scaled), 500),]) %>%
  # df.scaled[sample(nrow(df.scaled), 10000),] %>%
  ggplot() +
  geom_point(aes(y=rep.ratio, color=ref.type, x=as.character(SNM))) #+
  # scale_x_log10() 
  
  
bind_rows(df.scaled[(df.scaled$SNM==1),][sample(1899, 500),], df.scaled[sample(nrow(df.scaled), 500),]) %>%
  ggplot() +
  geom_point(aes(y=rep.ratio, x=net_tot, color=as.character(SNM))) +
  facet_wrap(vars(collision)) +
  scale_x_log10()

bind_rows(df.scaled[(df.scaled$SNM==1),][sample(1899, 1000),], df.scaled[sample(nrow(df.scaled), 1000),]) %>%
  ggplot() +
  geom_point(aes(y=rep.ratio, x=net_tot, color=as.character(SNM))) +
  facet_grid(cols =  vars(collision), rows=vars(rep.strand)) +
  scale_x_log10()

bind_rows(df.scaled[(df.scaled$SNM==1),][sample(1899),], df.scaled[sample(nrow(df.scaled), 1899),]) %>%
  ggplot() +
  geom_point(aes(x=rep.ratio, y=net_tot, color=as.character(SNM))) +
  facet_grid(cols = vars(tr.strand), rows=vars(rep.strand)) +
  scale_y_log10()

bind_rows(test.df[(test.df$SNM==1),][sample(1899),], test.df[sample(nrow(test.df), 1899),]) %>%
  ggplot() +
  geom_point(aes(x=rep.ratio, y=net_tot, color=as.character(SNM))) +
  facet_grid(cols = vars(tr.strand), rows=vars(rep.strand)) +
  scale_y_log10()


# test.df %>% ggplot() +
#   geom_point(aes(x=rep.ratio, y=net_tot, color=as.character(SNM))) +
#   facet_grid(cols = vars(tr.strand), rows=vars(rep.strand))


temp <- bind_rows(df.scaled[df.scaled$SNM==1,][sample(1899, 1000, replace = FALSE),],
          df.scaled[df.scaled$SNM==0,][sample(12069427, 1000, replace = FALSE),])
temp %>%
  ggplot() +
  geom_point(aes(y=rep.ratio, x=net_tot, color=as.character(SNM))) +
  facet_grid(cols =  vars(collision), rows=vars(rep.strand)) 

table(temp$rep.strand, temp$tr.strand)
table(temp$rep.strand, temp$collision)

test.df %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand))

test.df %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand)) +
  scale_x_log10()

collisions %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand))

collisions %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand)) +
  scale_x_log10()

df.scaled %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand))

df.scaled %>% ggplot() +
  geom_density(aes(x=net_tot)) +
  facet_grid(rows=vars(rep.strand), cols=vars(tr.strand))
```


Model making (yay!)

```{r}
mod <- glm(SNM ~ net_tot * rep.ratio * collision + CDS, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ net_tot * rep.ratio * collision + CDS, family = "binomial", 
    data = df.scaled)

Coefficients:
                              Estimate Std. Error  z value Pr(>|z|)    
(Intercept)                 -8.775e+00  2.570e-02 -341.386   <2e-16 ***
net_tot                      6.873e-06  4.625e-06    1.486   0.1373    
rep.ratio                   -1.943e-02  2.560e-02   -0.759   0.4479    
collision                    1.180e-01  6.636e-02    1.778   0.0754 .  
CDS                         -4.817e-02  5.014e-01   -0.096   0.9235    
net_tot:rep.ratio            6.184e-07  3.932e-06    0.157   0.8750    
net_tot:collision           -2.054e-05  1.099e-05   -1.870   0.0615 .  
rep.ratio:collision         -1.072e-01  6.883e-02   -1.558   0.1192    
net_tot:rep.ratio:collision  8.337e-07  1.027e-05    0.081   0.9353    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 37058  on 12071325  degrees of freedom
Residual deviance: 37047  on 12071317  degrees of freedom
AIC: 37065

Number of Fisher Scoring iterations: 13







```{r}
mod <- glm(SNM ~ net_tot * rep.ratio + CDS + collision * rep.strand + pwr.tot, family = "binomial", df.scaled)
summary(mod)
```

```{r}
mod <- glm(SNM ~ ref.type + collision * net_tot + CDS * rep.ratio + rep.strand + pwr.tot, family = "binomial", df.scaled)
summary(mod)
```

```{r}
mod <- glm(SNM ~ ref.type + collision * net_tot + CDS * rep.ratio + rep.strand + pwr.tot, family = "binomial", df.scaled)
summary(mod)
```

```{r}
mod <- glm(SNM ~ collision * net_tot + CDS * rep.ratio * rep.strand, family = "binomial", df.scaled)
summary(mod)
```

```{r}
mod <- glm(SNM ~ collision * net_tot * CDS * rep.ratio * rep.strand, family = "binomial", df.scaled)
summary(mod)
```

```{r}
mod <- glm(SNM ~ collision * net_tot * CDS, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ collision * net_tot * CDS, family = "binomial", 
    data = df.scaled)

Coefficients:
                        Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -8.765e+00  2.540e-02 -345.136   <2e-16 ***
collision              8.449e-02  6.199e-02    1.363   0.1729    
net_tot                5.864e-02  4.420e-02    1.327   0.1846    
CDS                   -3.059e+01  4.056e+03   -0.008   0.9940    
collision:net_tot     -1.869e-01  1.029e-01   -1.815   0.0695 .  
collision:CDS         -1.522e+03  2.291e+04   -0.066   0.9470    
net_tot:CDS            7.110e+00  8.784e+02    0.008   0.9935    
collision:net_tot:CDS -1.118e+04  1.622e+05   -0.069   0.9451    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 37058  on 12071325  degrees of freedom
Residual deviance: 37044  on 12071318  degrees of freedom
AIC: 37060

Number of Fisher Scoring iterations: 25


```{r}
mod <- glm(SNM ~ collision + net_tot * CDS, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ collision + net_tot * CDS, family = "binomial", 
    data = df.scaled)

Coefficients:
            Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -8.76953    0.02540 -345.305   <2e-16 ***
collision    0.07131    0.06066    1.176    0.240    
net_tot     -0.01189    0.03081   -0.386    0.700    
CDS         -0.25462    0.57650   -0.442    0.659    
net_tot:CDS  0.54385    0.27378    1.986    0.047 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 37058  on 12071325  degrees of freedom
Residual deviance: 37054  on 12071321  degrees of freedom
AIC: 37064

Number of Fisher Scoring iterations: 11

```{r}
mod <- glm(SNM ~ collision * net_tot + CDS, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ collision * net_tot + CDS, family = "binomial", 
    data = df.scaled)

Coefficients:
                  Estimate Std. Error  z value Pr(>|z|)    
(Intercept)       -8.76528    0.02538 -345.347   <2e-16 ***
collision          0.08754    0.06180    1.417   0.1566    
net_tot            0.06568    0.04234    1.551   0.1208    
CDS               -0.04349    0.50134   -0.087   0.9309    
collision:net_tot -0.19667    0.10246   -1.920   0.0549 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 37058  on 12071325  degrees of freedom
Residual deviance: 37052  on 12071321  degrees of freedom
AIC: 37062

Number of Fisher Scoring iterations: 12

```{r}
mod <- glm(SNM ~ collision * CDS + net_tot, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ collision * CDS + net_tot, family = "binomial", 
    data = df.scaled)

Coefficients:
               Estimate Std. Error  z value Pr(>|z|)    
(Intercept)   -8.768421   0.025380 -345.492   <2e-16 ***
collision      0.065207   0.060753    1.073    0.283    
CDS           -0.599304   0.999242   -0.600    0.549    
net_tot       -0.007936   0.028090   -0.283    0.778    
collision:CDS  0.905033   1.155504    0.783    0.433    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 37058  on 12071325  degrees of freedom
Residual deviance: 37056  on 12071321  degrees of freedom
AIC: 37066

Number of Fisher Scoring iterations: 11

```{r}
mod <- glm(SNM ~ collision * net_tot + rep.ratio + rep.strand, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ collision * net_tot + rep.ratio * rep.strand, 
    family = "binomial", data = df.scaled)

Coefficients:
                      Estimate Std. Error  z value Pr(>|z|)    
(Intercept)          -8.711346   0.025581 -340.537  < 2e-16 ***
collision             0.035842   0.061922    0.579   0.5627    
net_tot               0.052537   0.045377    1.158   0.2469    
rep.ratio            -0.098569   0.024071   -4.095 4.22e-05 ***
rep.strand            0.002211   0.024061    0.092   0.9268    
collision:net_tot    -0.178595   0.107472   -1.662   0.0966 .  
rep.ratio:rep.strand -0.003044   0.024072   -0.126   0.8994    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36561  on 11449703  degrees of freedom
Residual deviance: 36540  on 11449697  degrees of freedom
  (621622 observations deleted due to missingness)
AIC: 36554

Number of Fisher Scoring iterations: 12

```{r}
mod <- glm(SNM ~ ref.type + collision * net_tot + CDS + rep.ratio + rep.strand + pwr.tot, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ ref.type + collision * net_tot * CDS + rep.ratio + 
    rep.strand, family = "binomial", data = df.scaled)

Coefficients:
                        Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -9.230e+00  3.946e-02 -233.928  < 2e-16 ***
ref.typeG/C            1.021e+00  4.782e-02   21.358  < 2e-16 ***
collision              1.269e-02  6.224e-02    0.204    0.838    
net_tot               -8.210e-03  2.993e-02   -0.274    0.784    
CDS                   -2.936e+01  4.237e+03   -0.007    0.994    
rep.ratio             -9.502e-02  2.407e-02   -3.947  7.9e-05 ***
rep.strand             1.509e-02  2.383e-02    0.633    0.527    
collision:net_tot     -8.501e-02  9.309e-02   -0.913    0.361    
collision:CDS         -6.584e+02  7.572e+03   -0.087    0.931    
net_tot:CDS            6.867e+00  9.176e+02    0.007    0.994    
collision:net_tot:CDS -4.959e+03  4.516e+04   -0.110    0.913    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36561  on 11449703  degrees of freedom
Residual deviance: 36055  on 11449693  degrees of freedom
  (621622 observations deleted due to missingness)
AIC: 36077

Number of Fisher Scoring iterations: 25


Call:
glm(formula = SNM ~ ref.type + collision * net_tot * CDS + rep.ratio + 
    rep.strand + pwr.tot, family = "binomial", data = df.scaled)

Coefficients:
                        Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -9.315e+00  4.303e-02 -216.488  < 2e-16 ***
ref.typeG/C            1.013e+00  4.782e-02   21.188  < 2e-16 ***
collision             -1.156e-03  6.219e-02   -0.019 0.985171    
net_tot               -1.068e-02  3.219e-02   -0.332 0.740145    
CDS                   -2.939e+01  4.233e+03   -0.007 0.994462    
rep.ratio             -9.176e-02  2.416e-02   -3.798 0.000146 ***
rep.strand             1.922e-02  2.384e-02    0.806 0.420162    
pwr.tot                4.404e-01  7.197e-02    6.119 9.44e-10 ***
collision:net_tot     -8.122e-02  9.244e-02   -0.879 0.379632    
collision:CDS         -6.520e+02  7.577e+03   -0.086 0.931419    
net_tot:CDS            6.871e+00  9.168e+02    0.007 0.994020    
collision:net_tot:CDS -4.913e+03  4.522e+04   -0.109 0.913483    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36561  on 11449703  degrees of freedom
Residual deviance: 35995  on 11449692  degrees of freedom
  (621622 observations deleted due to missingness)
AIC: 36019

Number of Fisher Scoring iterations: 25



```{r}
mod <- glm(SNM ~ ref.type + collision * net_tot + rep.ratio + rep.strand, family = "binomial", df.scaled)
summary(mod)
```

Call:
glm(formula = SNM ~ ref.type + collision * net_tot + rep.ratio + 
    rep.strand, family = "binomial", data = df.scaled)

Coefficients:
                   Estimate Std. Error  z value Pr(>|z|)    
(Intercept)       -9.227842   0.038181 -241.684  < 2e-16 ***
ref.typeG/C        1.021297   0.047816   21.359  < 2e-16 ***
collision          0.005498   0.023073    0.238    0.812    
net_tot           -0.020170   0.026622   -0.758    0.449    
rep.ratio         -0.095712   0.024063   -3.978 6.96e-05 ***
rep.strand         0.016288   0.023809    0.684    0.494    
collision:net_tot -0.033894   0.034454   -0.984    0.325    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36561  on 11449703  degrees of freedom
Residual deviance: 36063  on 11449697  degrees of freedom
  (621622 observations deleted due to missingness)
AIC: 36077

Number of Fisher Scoring iterations: 12



```{r}
df.CDS <- df.scaled %>% filter(CDS == 1)
df.noCDS <- df.scaled %>% filter(CDS == 0)
```


```{r}
mod <- glm(SNM ~ net_tot + rep.ratio, family = "binomial", df.CDS)
summary(mod)
```

Call:
glm(formula = SNM ~ net_tot, family = "binomial", data = df.CDS)

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept)  -8.9853     0.5758 -15.604   <2e-16 ***
net_tot       0.5223     0.2722   1.919    0.055 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 77.935  on 25038  degrees of freedom
Residual deviance: 75.496  on 25037  degrees of freedom
AIC: 79.496

Number of Fisher Scoring iterations: 11


```{r}
mod <- glm(SNM ~ ref.type + collision * net_tot + rep.ratio + rep.strand, family = "binomial", df.noCDS)
summary(mod)
```

Call:
glm(formula = SNM ~ ref.type + collision * net_tot + rep.ratio + 
    rep.strand, family = "binomial", data = df.noCDS)

Coefficients:
                   Estimate Std. Error  z value Pr(>|z|)    
(Intercept)       -9.225815   0.038186 -241.600  < 2e-16 ***
ref.typeG/C        1.018211   0.047846   21.281  < 2e-16 ***
collision          0.004745   0.023168    0.205    0.838    
net_tot           -0.022324   0.028605   -0.780    0.435    
rep.ratio         -0.095393   0.024085   -3.961 7.47e-05 ***
rep.strand         0.015089   0.023835    0.633    0.527    
collision:net_tot -0.031640   0.034649   -0.913    0.361    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 36483  on 11424901  degrees of freedom
Residual deviance: 35989  on 11424895  degrees of freedom
  (621385 observations deleted due to missingness)
AIC: 36003

Number of Fisher Scoring iterations: 12

```{r}
mod <- glm(INDEL ~ ref.type + collision * net_tot * CDS + rep.ratio + rep.strand, family = "binomial", df.scaled)
summary(mod)
```

